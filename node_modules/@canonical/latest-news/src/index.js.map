{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["function revealSection() {\n  var latestNewsSection = document.querySelector(\"[data-js='latest-news']\");\n\n  if (latestNewsSection) {\n    latestNewsSection.classList.remove(\"u-hide\");\n  }\n}\n\nfunction formatDate(date) {\n  var parsedDate = new Date(date);\n  var monthNames = [\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n  ];\n  return (\n    parsedDate.getDate() +\n    \" \" +\n    monthNames[parsedDate.getMonth()] +\n    \" \" +\n    parsedDate.getFullYear()\n  );\n}\n\nfunction articleDiv(article, articleTemplateSelector, options) {\n  var articleFragment = getTemplate(articleTemplateSelector);\n  var time = articleFragment.querySelector(\".article-time\");\n  var link = articleFragment.querySelector(\".article-link\");\n  var title = articleFragment.querySelector(\".article-title\");\n  var image = articleFragment.querySelector(\".article-image\");\n  var author = articleFragment.querySelector(\".article-author\");\n  var excerpt = articleFragment.querySelector(\".article-excerpt\");\n  var group = articleFragment.querySelector(\".article-group\");\n  var url = \"\";\n  var imageLink = document.createElement(\"a\");\n\n  if (options.hostname) {\n    url = \"https://\" + options.hostname;\n  }\n\n  var articleImage;\n\n  if (\n    article._embedded &&\n    article._embedded[\"wp:featuredmedia\"] &&\n    article._embedded[\"wp:featuredmedia\"][0] &&\n    article._embedded[\"wp:featuredmedia\"][0].media_details &&\n    article._embedded[\"wp:featuredmedia\"][0].media_details.width &&\n    article._embedded[\"wp:featuredmedia\"][0].media_details.height\n  ) {\n    var media = article._embedded[\"wp:featuredmedia\"][0];\n    articleImage = {\n      url: media.source_url,\n      alt: media.alt_text,\n      width: media.media_details.width,\n      height: media.media_details.height,\n    };\n  }\n\n  if (author) {\n    author.innerHTML = article.author.name;\n  }\n\n  if (excerpt) {\n    excerpt.innerHTML = article.excerpt.rendered;\n  }\n\n  if (group) {\n    group.innerHTML = article.group.name;\n  }\n\n  if (time) {\n    time.setAttribute(\"datetime\", article.date);\n    time.innerText = formatDate(article.date);\n  }\n\n  if (link) {\n    link.href = url + \"/blog/\" + article.slug;\n\n    if (options.gtmEventLabel) {\n      link.onclick = function () {\n        dataLayer.push({\n          event: \"GAEvent\",\n          eventCategory: \"blog\",\n          eventAction: options.gtmEventLabel + \" news link\",\n          eventLabel: article.slug,\n        });\n      };\n    }\n  }\n\n  if (title) {\n    title.innerHTML = article.title.rendered;\n  }\n\n  if (image && articleImage && options.linkImage) {\n    imageLink.href = url + \"/blog/\" + article.slug;\n    image.appendChild(imageLink);\n  }\n\n  if (image && articleImage) {\n    var img = document.createElement(\"img\");\n    img.setAttribute(\"src\", articleImage.url);\n    img.setAttribute(\"alt\", articleImage.alt);\n    img.setAttribute(\"width\", articleImage.width);\n    img.setAttribute(\"height\", articleImage.height);\n\n    if (options.linkImage) {\n      imageLink.appendChild(img);\n    } else {\n      image.appendChild(img);\n    }\n  }\n\n  return articleFragment;\n}\n\nfunction getTemplate(selector) {\n  var template = document.querySelector(selector);\n  var fragment;\n\n  if (\"content\" in template) {\n    fragment = document.importNode(template.content, true);\n  } else {\n    fragment = document.createDocumentFragment();\n\n    for (var i = 0; i < template.childNodes.length; i++) {\n      fragment.appendChild(template.childNodes[i].cloneNode(true));\n    }\n  }\n\n  return fragment;\n}\n\nfunction latestArticlesCallback(options) {\n  return function (event) {\n    var articlesContainer = document.querySelector(\n      options.articlesContainerSelector\n    );\n\n    if (articlesContainer) {\n      while (articlesContainer.hasChildNodes()) {\n        articlesContainer.removeChild(articlesContainer.lastChild);\n      }\n\n      var data = JSON.parse(event.target.responseText);\n\n      if (\"spotlightContainerSelector\" in options) {\n        var spotlightContainer = document.querySelector(\n          options.spotlightContainerSelector\n        );\n\n        if (spotlightContainer) {\n          var latestPinned = data.latest_pinned_articles[0];\n\n          if (latestPinned) {\n            spotlightContainer.appendChild(\n              articleDiv(\n                latestPinned,\n                options.spotlightTemplateSelector,\n                options\n              )\n            );\n          }\n        } else {\n          console.warn(\"latest-news: No spotlight container found\");\n        }\n      }\n\n      if (data.latest_articles) {\n        data.latest_articles.forEach(function (article) {\n          articlesContainer.appendChild(\n            articleDiv(article, options.articleTemplateSelector, options)\n          );\n        });\n      }\n    } else {\n      console.warn(\"latest-news: No articles container found\");\n    }\n  };\n}\n\nfunction fetchLatestNews(options) {\n  var url = \"https://ubuntu.com/blog/latest-news\";\n  var params = [];\n  revealSection();\n\n  if (options.limit) {\n    params.push(\"limit=\" + options.limit);\n  }\n\n  if (options.tagId) {\n    params.push(\"tag-id=\" + options.tagId);\n  }\n\n  if (options.groupId) {\n    params.push(\"group-id=\" + options.groupId);\n  }\n\n  if (params.length) {\n    url += \"?\" + params.join(\"&\");\n  }\n\n  var oReq = new XMLHttpRequest();\n  oReq.addEventListener(\"load\", latestArticlesCallback(options));\n  oReq.open(\"GET\", url);\n  oReq.send();\n}\n\nif (typeof window.fetchLatestNews == \"undefined\") {\n  window.fetchLatestNews = fetchLatestNews;\n}\n\nexport {\n  articleDiv,\n  fetchLatestNews,\n  formatDate,\n  getTemplate,\n  latestArticlesCallback,\n  revealSection,\n};\n//# sourceMappingURL=index.js.map\n"],"names":["latestNewsSection","document","parsedDate","monthNames","spotlightContainer","data","revealSection","oReq"],"mappings":"AAAA,SAAA,aAAA,GAAyB;AACvB,MAAIA,iBAAiB,GAAGC,QAAQ,CAARA,aAAAA,CAAxB,yBAAwBA,CAAxB;;AAEA,MAAA,iBAAA,EAAuB;AACrBD,IAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,MAAAA,CAAAA,QAAAA;AACD;AACF;;AAED,SAAA,UAAA,CAAA,IAAA,EAA0B;AACxB,MAAIE,UAAU,GAAG,IAAA,IAAA,CAAjB,IAAiB,CAAjB;AACA,MAAIC,UAAU,GAAd,CAkJM,SAlJN,EAsJUC,UAtJV,SAAA,SAAA,EAoKMC,KApKN,EAoKMA,MApKN,EAoKMA,MApKN,EAoKMA,QApKN,aAAA,EAoKMA,SApKN,YAAA,YAAA,CAAA;gCAmLA,MACAC,UAAAA,CAAAA,UAAAA,CAAAA,QAAAA,EAAAA;;;AAqBAC,SAAAA,UAAAA,CAAAA,OAAAA,EAAAA,uBAAAA,EAAAA,OAAAA,EAAAA;AACD,MADCA,eAAAA,GAAAA,WAAAA,CAAAA,uBAAAA,CACD;aADCA,eAAAA,CAAAA,aAAAA,CAAAA,eAAAA;AACD,MAAA,IAAA,GADCA,eAAAA,CAAAA,aAAAA,CAAAA,eAAAA,CACD;8BADCA,cAAAA;AAAAA,MAAAA,KAAAA,GAAAA,eAAAA,CAAAA,aAAAA,CAAAA,gBAAAA,CAAAA;AAAAA,MACD,MAAA,GAAA,eAAA,CAAA,aAAA,CAAA,iBAAA,CADCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}